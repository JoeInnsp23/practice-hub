--- a/app/api/webhooks/docuseal/route.ts
+++ b/app/api/webhooks/docuseal/route.ts
@@ -63,7 +63,76 @@ async function handleWebhookEvent(
   const eventType = body_data.submission?.status;

   if (eventType === "completed") {
-    // ... existing handler for completed event
+    // Existing handler for completed event...
+    await db
+      .update(proposals)
+      .set({ status: "signed", updatedAt: new Date() })
+      .where(eq(proposals.id, proposalId));
+
+    // ... rest of existing handler
+  } else if (eventType === "declined") {
+    // ✅ NEW: Handle signature decline/rejection
+    await db
+      .update(proposals)
+      .set({
+        status: "rejected",
+        updatedAt: new Date(),
+      })
+      .where(eq(proposals.id, proposalId));
+
+    // Log activity
+    await db.insert(activityLogs).values({
+      tenantId,
+      entityType: "proposal",
+      entityId: proposalId,
+      action: "proposal_signature_declined",
+      description: `Proposal signature declined by ${submission.submitter?.email || "unknown"}`,
+      userId: "system",
+      userName: "DocuSeal Webhook",
+      oldValues: { status: proposal.status },
+      newValues: { status: "rejected" },
+    });
+
+    // Notify team
+    const toast = await import("react-hot-toast").then((m) => m.default);
+    toast.error(
+      `Proposal "${proposal.title}" signature was declined by ${submission.submitter?.email}`
+    );
+
+    // Send email to proposal creator
+    await sendEmail({
+      to: proposal.createdByEmail || "",
+      subject: `Proposal Signature Declined: ${proposal.proposalNumber}`,
+      template: "proposal_declined_notification",
+      data: {
+        proposalNumber: proposal.proposalNumber,
+        signerEmail: submission.submitter?.email,
+        declinedAt: new Date().toISOString(),
+      },
+    });
+
+    Sentry.captureMessage("Proposal signature declined", {
+      tags: { operation: "webhook_declined" },
+      extra: { proposalId, signerEmail: submission.submitter?.email },
+    });
+  } else if (eventType === "expired") {
+    // ✅ NEW: Handle signature expiry
+    await db
+      .update(proposals)
+      .set({
+        status: "expired",
+        updatedAt: new Date(),
+      })
+      .where(eq(proposals.id, proposalId));
+
+    // Log activity
+    await db.insert(activityLogs).values({
+      tenantId,
+      entityType: "proposal",
+      entityId: proposalId,
+      action: "proposal_signature_expired",
+      description: "Proposal signature link expired",
+      userId: "system",
+      userName: "DocuSeal Webhook",
+      oldValues: { status: proposal.status },
+      newValues: { status: "expired" },
+    });
+
+    // Send email to proposal creator
+    await sendEmail({
+      to: proposal.createdByEmail || "",
+      subject: `Proposal Signature Expired: ${proposal.proposalNumber}`,
+      template: "proposal_expired_notification",
+      data: {
+        proposalNumber: proposal.proposalNumber,
+        expiredAt: new Date().toISOString(),
+      },
+    });
+
+    Sentry.captureMessage("Proposal signature expired", {
+      tags: { operation: "webhook_expired" },
+      extra: { proposalId },
+    });
   } else {
-    // Unsupported event
+    // Unsupported event type
+    Sentry.captureMessage("Unsupported DocuSeal webhook event", {
+      tags: { operation: "webhook_unsupported_event" },
+      extra: { eventType, submissionId },
+    });
   }
 }
